name: Labels Checker
on:
  pull_request:
    branches: [manta]
jobs:
  check_l_labels:
    name: L- Labels Check
    runs-on: ubuntu-20.04
    steps:
      - uses: docker://agilepathway/pull-request-label-checker:latest
        with:
          any_of: |
            L-added,
            L-changed,
            L-fixed,
            L-deprecated,
            L-removed,
            L-release
          repo_token: ${{ secrets.GITHUB_TOKEN }}
      - name: Check L-release
        id: release_check
        uses: docker://agilepathway/pull-request-label-checker:latest
        with:
          all_of: L-release
          repo_token: ${{ secrets.GITHUB_TOKEN }}
      - name: L-release result
        if: steps.release_check.conclusion == 'success'
        run: |
          if [[ ${{ github.head_ref }} =~ ^release-v[0-9]+\.[0-9]+\.[0-9]+(\-[0-9]+)? ]]; then
            echo "Release with L-release is ok"
            exit 0
          else
            echo "Non Release branches should not have L-release label"
            exit 1
          fi


